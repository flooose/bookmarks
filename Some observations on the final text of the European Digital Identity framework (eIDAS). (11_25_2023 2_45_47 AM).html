<!DOCTYPE html> <html xmlns=http://www.w3.org/1999/xhtml lang xml:lang style><!--
 Page saved with SingleFile 
 url: https://blog.xot.nl/2023/11/20/some-observations-on-the-final-text-of-the-european-digital-identity-framework-eidas/index.html 
 saved date: Sat Nov 25 2023 02:45:47 GMT-0700 (Mountain Standard Time)
--><meta charset=utf-8>
<meta name=generator content=pandoc>
<meta name=viewport content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name=author content="Jaap-Henk Hoepman">
<meta name=dcterms.date content="November 20, 2023">
<meta name=keywords content="eID, surveillance, backdoor, lawful-interception, privacy, attribute-based-credentials">
<title>Some observations on the final text of the European Digital Identity framework (eIDAS).</title>
<style>code{white-space:pre-wrap}:root{--accent-color:#ff8a00}div#canvas{font-family:"Cambria",charter,serif}h1,h2{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;color:var(--accent-color)}h2{line-height:1.1em}p{margin:0px;margin-bottom:1em}code{font-family:courier,monospaced}blockquote::before{display:block;height:0px;margin-left:-35px;content:"///";color:var(--accent-color)}blockquote{font-style:italic}a:link{text-decoration:none;color:var(--accent-color)}a:visited{color:grey}div#menu{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;font-size:0.9em}div#posterror{border-top:1px solid lightgrey;padding-top:10px}div#postreply{border-bottom:1px solid lightgrey;padding-bottom:10px}body{background-color:white}div#canvas{color:black}div#menu{text-align:right}div#postheader{margin:0px;padding:10px;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}h1#title{margin:0px;padding:0px;font-size:2.0em;line-height:1.05em;hyphens:auto}div#postdate{font-family:"Helvetica Neue Light",Helvetica,Arial,sans-serif}div#posttags{font-size:0.9em}div#postcategories{font-size:0.9em}div#postcontent{margin:0px;padding:10px}div#footer{padding:10px;padding-top:0px;padding-bottom:30px}@media screen and (min-width:900px){div#canvas{width:900px;margin:auto;font-size:1em;line-height:1.2em}div#header{position:absolute;box-sizing:border-box;width:300px;bottom:0px;margin:0px;padding:10px}div#post::after{content:"";display:table;clear:both}div#postheader{float:left;box-sizing:border-box;width:33%;text-align:right}h1#title{text-align:right}div#postdate{padding-top:20px;text-align:right}div#posttags::before{content:"/// Tags ///"}div#posttags{padding-top:20px;text-align:right}a.posttag{display:block}div#postcategories::before{content:"/// Categories ///"}div#postcategories{padding-top:20px;text-align:right}a.postcategory{display:block}div#postcontent{float:right;box-sizing:border-box;width:66%}div#footer{float:right;width:66%;box-sizing:border-box;margin:0px}}@media screen and (max-width:900px){div#canvas{width:auto;max-width:700px;font-size:0.9em;line-height:1.1em}div#header{padding:10px}h1#title{text-align:left}div#postdate{padding-top:10px;text-align:left}div#posttags::before{content:"Tags ///"}div#posttags{padding-top:5px;text-align:left}div#postcategories::before{content:"Categories ///"}div#postcategories{padding-top:5px;text-align:left}}</style>
<meta name=referrer content=no-referrer><link rel=canonical href=https://blog.xot.nl/2023/11/20/some-observations-on-the-final-text-of-the-european-digital-identity-framework-eidas/index.html><meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:; frame-src 'self' data:;"><style>img[src="data:,"],source[src="data:,"]{display:none!important}</style></head>
<body>
 <div id=canvas>
 <div id=header>
 <div id=menu>
 <a href=https://blog.xot.nl/index.html>Home</a> //
 <a href=https://blog.xot.nl/about-2/index.html>About</a>
 // <a href=https://blog.xot.nl/2023/10/24/clearghost-using-the-laws-of-nature-to-limit-digital-surveillance-by-law-enforcement/index.html>Previous</a>
 </div>
 </div>
 <div id=post>
 <div id=postheader>
 <h1 id=title>Some observations on the final text of the European
Digital Identity framework (eIDAS).</h1>
 <div id=postdate>November 20, 2023</div>
 <div id=postcategories>
<a class=postcategory href=https://blog.xot.nl/category/opeds/index.html>opeds</a>
 </div>
 <div id=posttags>
<a class=posttag href=https://blog.xot.nl/tag/eid/index.html>eID</a>
<a class=posttag href=https://blog.xot.nl/tag/surveillance/index.html>surveillance</a>
<a class=posttag href=https://blog.xot.nl/tag/backdoor/index.html>backdoor</a>
<a class=posttag href=https://blog.xot.nl/tag/lawful-interception/index.html>lawful-interception</a>
<a class=posttag href=https://blog.xot.nl/tag/privacy/index.html>privacy</a>
<a class=posttag href=https://blog.xot.nl/tag/attribute-based-credentials/index.html>attribute-based-credentials</a>
 </div>
 </div>
 <div id=postcontent>
 <p>The <a href=https://www.europarl.europa.eu/cmsdata/278103/eIDAS-4th-column-extract.pdf>final
 text</a> of the update to the eIDAS regulation (establishing a
 framework for a European Digital Identity) has been agreed upon. In a
 last minute effort to improve the text, <a href=https://eidas-open-letter.org/>we wrote an open letter</a>
 criticising the proposal on weakening the security of the web, and
 providing too few safeguards protecting users of the proposed European
 Identity Wallet. Were we successful?</p>
 <p>Looking at the text, it is clear this is a compromise (and an
 amendment to an existing regulation). In particular the structure is a
 mess, with new articles introducing the identity wallet running as far
 as four levels deep. This is a tough read. (Also, someone at the
 Commission needs to carefully cross-check all references because
 e.g.&nbsp;Article 45a-1.4 refers to Article 17(3)(c) that appears to no
 longer to exist.) I guess that’s life when regulating a hotly
 contested topic.</p>
 <p>Let’s study the two topics we addressed in our open letter: web
 security, and wallet privacy.</p>
 <h2 id=weakening-the-security-of-the-web>Weakening the security of
 the web</h2>
 <p>We were concerned about the phrasing of Article 45, that lays down
 a requirement for browsers to recognise any certificate that satisfies
 some criteria specified in an annex to the regulation, <em>without any
 other requirements to be imposed by the browsers</em>. We were
 especially concerned that browsers were prevented from running
 additional security checks when such certificates were being used to
 authenticate a website, depending on how you would read Article
 45a.</p>
 <p>Why would this be a problem?</p>
 <p>For a browser to ‘recognise’ a certificate means that the issuer of
 the certificate (the party that signs the contents of the certificate)
 is added to the trusted root list of a browser. When a browser visits
 a website, it asks the website to provide a valid certificate
 (i.e.&nbsp;one signed by <em>any</em> of the issuers in its trusted root
 list). The certificate contains the domain name of the website (which
 the browsers checks against the domain name in the link for the
 website it is visiting) and a public key for that domain. The issuer
 has verified that the public key indeed belongs to that website. And
 the browser verifies the signature on the certificate it just received
 to ensure correctness of this information. It then challenges the
 website to prove it knows the private key corresponding to the public
 key found in the certificate, while at the same time establishing a
 session key to encrypt the communication between the browser and the
 website.</p>
 <p>This complex protocol proves authenticity of the website and
 guarantees confidentiality of the communication between the browser
 and the website, <strong>provided that all issuers in the trusted root
 list refrain from issuing rogue certificates that link the wrong
 public key to a website domain</strong>. If not, a malicious entity
 (say a law enforcement agency in a member state) could mount a <a href=https://en.wikipedia.org/wiki/Man-in-the-middle_attack>man-in-the-middle
 attack</a> pretending to be the actual website at domain
 <code>suspicious-forum.net</code> by sending a rogue certificate for
 that domain (that it forced one of the issuers in the member state to
 sign), thus getting hold of the encryption key used to protect the
 communication, and thus being able to eavesdrop on that communication.
 This would break the end-to-end encryption guarantee for websites, and
 would allow law enforcement to surreptitiously surveil visitors of
 websites.</p>
 <p>Security mechanisms currently implemented in browsers (like <a href=https://en.wikipedia.org/wiki/Certificate_Transparency>certificate
 transparency</a>) would detect and prevent such an abuse - but
 browsers might not be allowed to act upon it depending on how you
 would read Article 45 and 45a.</p>
 <p>Unfortunately, Article 45 itself has not changed since we published
 our letter. However, the following was added to Recital 32:</p>
 <blockquote>
 <p>The obligation of recognition, interoperability and support of
 QWACs is not to affect the freedom of web-browser providers to ensure
 web security, domain authentication and the encryption of web traffic
 in the manner and with the technology they consider most
 appropriate.</p>
 </blockquote>
 <p>This still means that browsers have to unilaterally recognise
 certificates that satisfy the requirement specified in the annex to
 the regulation, which could be much weaker than those typically
 imposed ex ante by browsers. In practice this means that issuers of
 such certificates have to be added to the trusted root list in the
 browser, creating a less secure PKI for the web.</p>
 <p>But given the changes to recital 32 I am much less worried about
 the actual risk of breaking the end-to-end encryption for websites by
 e.g.&nbsp;law enforcement. In particular, with the text added to recital
 32, I believe that Article 45a.2</p>
 <blockquote>
 <p>By way of derogation to paragraph 1 and only in case of
 substantiated concerns related to breaches of security or loss of
 integrity of an identified certificate or set of certificates,
 web-browsers may take precautionary measures in relation to that
 certificate or set of certificates.</p>
 </blockquote>
 <p>allows browsers to continue to use the security mechanism (like
 certificate transparency) to detect and prevent such attacks to
 end-to-end encryption, by refusing to accept such a rogue
 certificate.</p>
 <p>Moreover, article 45a.3 requires the browser (vendor) to notify the
 competent supervisory authority in the member state <em>and</em> the
 Commission of such attacks taking place. Even though article 45a.4
 puts the sole authority to investigate and decide on the final
 withdrawal of such a certificate on the competent authority (of the
 member state whose law enforcement agency in the example above
 initiated the wilful subversion of the end-to-end encryption of the
 web), I simply cannot believe that any competent authority could claim
 there is nothing wrong and that the certificate should be reinstated:
 they would be very clearly and publicly be caught red-handed in
 subverting global web security.</p>
 <h2 id=privacy-of-the-wallet>Privacy of the wallet</h2>
 <p>Regarding the identity wallet, we were concerned about the lack of
 privacy guarantees when using it to reveal certain non-identifying
 attributes (like age) to service providers. In particular, we were
 worried that users would not be sufficiently protected against service
 providers asking for more information than necessary for offering
 their service (i.e.&nbsp;<em>over-authentication</em>). Also, we were
 worried that the use of the wallet and the use of the attribute
 certificates contained in it could be ‘linkable’, i.e.&nbsp;that visits by
 a particular user to different websites could be linked (by the issuer
 or the websites).</p>
 <p>It appears that our concerns have been addressed, somewhat.</p>
 <p>Regarding the risk of <em>over-authentication</em>, I am quite
 happy to see that the registration process of relying parties has been
 strengthened.</p>
 <p>Article 6a.4.(ba) requires that “the identity of relying parties
 can be validated by implementing authentication mechanisms in
 accordance with Article 6b”. Moreover, the attributes relying parties
 are allowed to request from wallet users must be specified upfront and
 be made “available online in electronically signed or sealed form
 suitable for automated processing” (Article 6b.1e). Wallets shall use
 this information to “implement the appropriate mechanism to inform
 that the requesting relying party or the requesting user of European
 Digital Identity Wallets have the permission to access [these
 attributes]” (Article 6a.4.(ca).</p>
 <p>Together these provide some technically enforced mechanism to
 prevent ‘over-authentication’ by relying parties.</p>
 <p>The situation regarding unlinkability is less clear. Article
 6a.4.(a).(4e) says that</p>
 <blockquote>
 <p>European Digital Identity Wallets shall, in particular support
 common protocols and interfaces for relying parties to verify the
 authenticity and validity of European Digital Identity Wallets</p>
 </blockquote>
 <p>and Article 6a.5.5a says that</p>
 <blockquote>
 <p>Member States shall provide means to revoke the validity of [a
 specific] European Digital Identity Wallet</p>
 </blockquote>
 <p>Both requirements seem to imply that the validity of specific
 wallets can individually be checked by relying parties, which is hard
 (though not impossible, see below) to align with any unlinkability
 requirement.</p>
 <p>Article 6a.7b.(a) on the other hand says that</p>
 <blockquote>
 <p>The technical framework of the European Digital Identity Wallet
 shall not allow providers of electronic attestations of attributes or
 any other party, after the issuance of the attestation of attributes,
 to obtain data that allows for tracking, linking, correlating or
 otherwise obtain knowledge of transactions or user behaviour unless
 explicitly authorised by the user.</p>
 </blockquote>
 <p>The problem is that the most recent public version (i.e.&nbsp;version
 1.0) of the Architecture Reference Framework (ARF) only allows the use
 of standardised ‘boring’ cryptographic primitives that do not allow
 the implementation of truly multi-show unlinkable attribute
 certificates (ABCs). As far as I understand, wallets work around this
 by requiring issuers to issue several one-time use certificates in one
 go. Users can use each of these only once and then throw them away.
 Clearly, this reveals the number of times you reveal a particular
 attribute to the issuer because you need to request new ones once your
 current stack in the wallet is empty. Also, issuers and relying
 parties can collude to track the use of such traditional certificates
 and link them back to you, which seems to contradict the language in
 6a.7b.(a) “shall not allow…”.</p>
 <p>Now this might all very well mean that the ARF needs to be updated
 to actually include cryptographic primitives that allow multi-show
 ABCs to be implemented. If that’s the case: hurray! To satisfy the
 requirement to verify the authenticity of wallets and to revoke
 specific wallets, so-called blacklistable credentials could be used.
 In any case, protocols to <a href=http://www.cs.ru.nl/~jhh/publications/epoch-revocation-journal.pdf>revoke
 ABCs in a privacy friendly fashion</a> exist.</p>
 <p>For my earlier commentary on the eIDAS proposal, see</p>
 <ul>
 <li><a href=https://blog.xot.nl/2021/06/14/the-european-digital-identity-framework/index.html>The
 European Digital Identity framework</a>,</li>
 <li><a href=https://blog.xot.nl/2022/01/31/civil-liberties-aspects-of-the-european-digital-identity-framework/index.html>Civil
 liberties aspects of the European Digital Identity Framework</a>,
 and</li>
 <li><a href=https://blog.xot.nl/2023/02/14/analysing-the-architecture-of-the-european-digital-identity-framework/index.html>Analysing
 the Architecture of the European Digital Identity Framework</a>.</li>
 </ul>
 <div id=posterror>
 In case you spot any errors on this page, please
 <a href="mailto:blog@xot.nl?subject=NOTIFICATION:%202023/11/20/some-observations-on-the-final-text-of-the-european-digital-identity-framework-eidas/comment.">notify</a> me!
 </div>
 <div id=postreply>
 Or, leave a
 <a href="mailto:blog@xot.nl?subject=COMMENT:%202023/11/20/some-observations-on-the-final-text-of-the-european-digital-identity-framework-eidas/comment.">comment</a>.
 </div>
 </div>
 </div>
 <div id=footer>
 <a id=search href="https://www.startpage.com/do/dsearch?query=site:blog.xot.nl">Search</a>
 ///
 <a id=archives href=https://blog.xot.nl/archives.html>Archives</a>
 ///
 <a id=categories href=https://blog.xot.nl/categories.html>Categories</a>
 ///
 <a id=tags href=https://blog.xot.nl/tags.html>Tags</a>
 ///
 <a id=feed href=https://blog.xot.nl/feed/>RSS Feed</a>
 ///
 <a id=subscribe href="mailto:blog@xot.nl?subject=Subscribe">Subscribe</a>
 <hr>
 Made with <a href=https://github.com/xot/ssst>SSST</a>. 
 </div>
 </div>
